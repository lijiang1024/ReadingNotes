
# 第一行代码 第二版 读书笔记

## 第一章

-----

#### <span style="color: white;">1、Android系统架构</span>

> *<span style="color: grey;">Android大致可分为四层架构：Linux内核层、系统运行库层、应用框架层 和 应用层</span>*

1. Linux内核层
    * Android系统是基于Linux内核的，这一层为Android设备的各种硬件提供了底层的驱动。

2. 系统运行库层
    * 通过一些 C/C++ 库来为Android系统提供主要的特性支持。
    * 包含Android运行时库，提供了一些核心库，能够允许开发者使用Java语言编写Android应用。Android运行时库中还包含了Dalvik虚拟机（5.0系统之后改为ART运行环境）。

3. 应用框架层
    * 提供了构建应用程序时可能用到的各种API。

4. 应用层
    * 所有安装在手机上的应用程序都属于这一层。

-----

#### <span style="color: white;">2、Android应用开发特色</span>

1. 四大组件
    * Activity
    * Service
    * Broadcast Receiver
    * Content Provider

2. 丰富的系统控件

3. SQLite数据库
    
    > *<span style="color: grey;">SQLite数据库 是一种轻量级、运算速度极快的嵌入式关系型数据库</span>*

4. 强大的多媒体

5. 地理位置定位

-----

#### <span style="color: white;">3、Android Studio创建的Android项目的结构解析（HelloWorld）</span>

```
-- HelloWorld\
   |-- .gradle\
   |-- .idea\
   |-- app\
   |   |-- build\
   |   |-- libs\
   |   |-- src\
   |   |   |-- androidTest\
   |   |   |-- main\
   |   |   |   |-- java\
   |   |   |   |-- res\
   |   |   |   |   |-- drawable\
   |   |   |   |   |-- layout\
   |   |   |   |   |-- mipmap-hdpi\ 
   |   |   |   |   |-- mipmap-mdpi\
   |   |   |   |   |-- mipmap-xhdpi\
   |   |   |   |   |-- mipmap-xxhdpi\
   |   |   |   |   |-- mipmap-xxxhdpi\
   |   |   |   |   |-- values\
   |   |   |   |   |-- values-w820dp\
   |   |   |   |-- AndroidManifest.xml
   |   |   |
   |   |   |-- test\
   |   |
   |   |-- .gitignore
   |   |-- app.iml
   |   |-- build.gradle
   |   |-- proguard-rules.pro
   |   
   |-- build\
   |-- gradle\
   |-- .gitignore
   |-- build.gradle
   |-- gradle.properties
   |-- gradlew
   |-- gradlew.bat
   |-- HelloWorld.iml
   |-- local.properties
   |-- settings.gradle
```

1. **项目结构解析**
    
    * .gradle\ 和 .idea\

        这两个目录下放的是Android Studio自动生成的一些文件，无需关心，也不要去手动编辑。

    * app\

        项目中的代码、资源等内容几乎都放在这个目录下面。

    * build\

        这个目录不需要关心，它主要包含了一些在编译时自动生成的文件

    * gradle\

        这个目录下包含了gradle wrapper的配置文件，使用gradle wrapper的方式，不需要提前将gralde下载好，而是会自动根据本地缓存情况决定是否需要联网下载gradle。Android Studio默认没有启用gradle wrapper的方式，如果需要打开，可以点击Android Studio导航栏 --> File --> Settings --> Build, Execution, Deployment --> Gradle，进行配置更改。

    * .gitignore

        这个文件是用来将指定的目录或文件排除在版本控制之外

    * build.gradle

        这是项目全局的gradle构建脚本，通常这个文件是不需要修改的。

    * gradle.properties

        这个文件是全局的gradle配置文件，在这里配置的属性将会影响到项目中所有的gradle编译脚本

    * gradlew 和 gradlew.bat

        这两个文件是用来在命令行界面执行gradle命令的，其中gradlew是在 Linux 或 Mac 系统中使用的，gradlew.bat是在 Windows 系统中使用的。

    * HelloWorld.iml

        iml文件是所有 IntelliJ IDEA 项目都会自动生成的一个文件（Android Studio 是基于IntelliJ IDEA 开发的）

    * local.properties

        这个文件用于指定本机中的Android SDK路径，通常内容都是自动生成的，我们不需要修改。

    * settings.gradle

        这个文件用于指定项目中所有引入的模块。通常情况下，模块的引入都是自动完成的，需要我们手动去修改这个文件的场景可能比较少。

2. **app目录结构解析**

    * build\

        这个目录和外层的 build 目录类似，主要也是包含了一些在编译时自动生成的文件。

    * libs\

        如果项目中使用到第三方jar包，就需要把这些jar包都放在libs目录下，放在这个目录下的jar包都会被自动添加到构建路径里去。

    * androidTest\

        这个目录是用来编写Android Test测试用例的，可以对项目进行一些自动化测试。

    * java\

        java目录是放置项目中的Java代码的地方。

    * res\

        在项目中使用的所有图片、布局、字符串等资源都要存放在这个目录下。这个目录中还有很多子目录，图片放在drawable目录下，布局文件放在layout目录下，字符串放在values目录下，

        > drawable开头的目录都是用来存放图片的；mipmap开头的目录都是用来存放应用图标的；values开头的目录都是用来存放字符串、样式、颜色等配置的；layout开头的目录是用来存放布局文件的。

    * AndroidManifest.xml

        这是整个Android项目的配置文件，在程序中定义的四大组件都需要在这个文件里注册，还可以在这个文件中给应用添加权限声明。

    * test\

        这个目录是用来编写Unit Test测试用例的，是对项目进行自动化测试的另一种方式。

    * .gitignore

        这个文件用于将app模块内的指定的目录或文件排除在版本控制之外，作用和外层的gitignore文件类似。

    * app.iml

        IntelliJ IDEA 项目自动生成的文件，不需要关心或修改这个文件中的内容。

    * build.grade

        这是app模块的gradle构建脚本，这个文件中会指定很多项目构建相关的配置。

    * proguard-rules.pro

        这个文件用于指定项目代码的混淆规则。


3. <b>build.gradle详解</b>

    > Android Studio采用Gradle构建项目。Gradle是一个非常先进的项目构建工具，使用一种基于Groovy的领域特定语言（DSL）来声明项目设置。
    
    * <b><i>外层目录的build.gradle文件中的代码</i></b>
        ```
            buildscript {
                repositories {
                    jcenter()
                }
                dependencies {
                    classpath 'com.android.tools.build:gradle:2.2.3'

                    // NOTE: Do not place your application dependencies here; they belong
                    // in the individual module build.gradle files
                }
            }

            allprojects {
                repositories {
                    jcenter()
                }
            }

            task clean(type: Delete) {
                delete rootProject.buildDir
            }
        ```
    
        * 首先两处 repositories 闭包中都声明了 jcenter() 配置， jcenter 是一个代码托管仓库，很多Android项目都会选择将代码托管到 jcenter 上，声明这行配置之后，就可以在项目中轻松引用 jcenter 上的开源项目了。

        * dependencies 闭包中使用 classpath 声明了一个Gradle插件。如果想使用Gradle构建Android项目，则需要声明 com.android.tools.build:gradle:2.2.3 这个插件。其中最后的部分是插件的版本号。

        > 通常不需要修改外层目录下的build.gradle文件，除非想添加一些全局的项目构建配置。

    * <b><i>app目录的build.gradle文件中的代码</i></b>
        ```
            apply plugin: 'com.android.application'

            android {
                compileSdkVersion 25
                buildToolsVersion "25.0.0"
                defaultConfig {
                    applicationId "org.liti.helloandroid"
                    minSdkVersion 19
                    targetSdkVersion 25
                    versionCode 1
                    versionName "1.0"
                    testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
                }
                buildTypes {
                    release {
                        minifyEnabled false
                        proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
                    }
                }
            }

            dependencies {
                compile fileTree(dir: 'libs', include: ['*.jar'])
                androidTestCompile('com.android.support.test.espresso:espresso-core:2.2.2', {
                    exclude group: 'com.android.support', module: 'support-annotations'
                })
                compile 'com.android.support:appcompat-v7:25.0.1'
                compile 'com.android.support:design:25.0.1'
                testCompile 'junit:junit:4.12'
                compile 'com.orhanobut:logger:1.15'
            }
        ```
        
        * 第一行应用了一个插件，一般有两种值可选： com.android.application 表示这是一个应用程序模块； com.android.library 表示这是一个库模块。【两者的区别，应用程序模块可以直接运行，库模块只能作为代码依附于应用程序模块来运行】

        * android闭包，在这个闭包中可以配置项目构建的各种属性
            
            * compileSdkVersion 用于指定项目的编译版本
            
            * buildToolsVersion 用于指定项目构建工具的版本
            
            * defaultConfig闭包 在这里面可以对项目的更多细节进行配置

                * applicationId 用于指定项目的包名

                * minSdkVersion 用于指定项目最低兼容的Android系统版本

                * targetSdkVersion 指定的值表示在该目标版本上已经做了充分的测试，系统将会为你的应用程序启用一些最新的功能和特性

                * versionCode 用于指定项目的版本号

                * versionName 用于指定项目的版本名称

            * buildTypes闭包 用于指定生成安装文件的相关配置，通常只会有两个闭包，一个是debug【debug闭包用于指定生成测试版安装文件的配置】，一个是release【release闭包用于生成正式版安装文件的配置】。

                * release闭包的内容：minifyEnabled 用于指定是否对项目的代码进行混淆，true表示混淆，false表示不混淆；proguardFiles 用于指定混淆时使用的规则文件【这里指定了两个混淆文件：第一个proguard-android.txt 是在AndroidSDK目录下的，里面是所有项目的通用混淆规则；第二个proguard-rules.pro 是在当前项目的根目录下的，里面可以编写当前项目特有的混淆规则】。

        * dependencies闭包 可以指定当前项目所有的依赖关系。
            > 通常Android Studio 项目有3种依赖方式：本地依赖、库依赖 和 远程依赖
        
            * 本地依赖 可以对本地的jar包或目录添加依赖关系【compile fileTree(dir: 'libs', include: ['*.jar'])】

            * 库依赖 可以对项目中的库模块添加依赖关系【比如有个一库模块名字叫helper，添加库依赖的声明语句为 compile project(':helper')】

            * 远程依赖 可以对 jcenter 库上的开源项目添加依赖关系【compile 'com.orhanobut:logger:1.15'】

            * testCompile 用于声明测试用例库


-----
-----

## 第二章







